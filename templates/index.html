<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GA Cash 3 Predictor</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h1>GA Cash 3 Predictor</h1>

    <h2>Prediction for Next Draw:</h2>
    {% if prediction %}
        <p><strong>{{ prediction[0] }} - {{ prediction[1] }} - {{ prediction[2] }}</strong></p>
    {% else %}
        <p>Prediction data not available.</p>
    {% endif %}

    <h2>Accuracy (Last {{ filter_value }} draws)</h2>
    <ul>
        <li>Exact Matches: {{ accuracy.exact }}</li>
        <li>Any Order Matches: {{ accuracy.any_order }}</li>
        <li>Total Draws Evaluated: {{ accuracy.total }}</li>
    </ul>

    <label for="drawFilter">Show accuracy over:</label>
    <select id="drawFilter" onchange="applyFilter()">
        <option value="10" {% if filter_value == 10 %}selected{% endif %}>Last 10</option>
        <option value="20" {% if filter_value == 20 %}selected{% endif %}>Last 20</option>
        <option value="30" {% if filter_value == 30 %}selected{% endif %}>Last 30</option>
    </select>

    <div id="accuracyChart" style="width:100%;height:400px;"></div>

    <script>
        function applyFilter() {
            const filter = document.getElementById("drawFilter").value;
            window.location.href = "/?filter=" + filter;
        }

        const chartData = {{ chart_data|safe }};
        const dates = chartData.map(item => item.date);
        const values = chartData.map(item => item.accuracy);

        const trace = {
            x: dates,
            y: values,
            type: 'scatter',
            mode: 'lines+markers',
            line: { shape: 'linear' },
            marker: { color: 'green' }
        };

        const layout = {
            title: 'Prediction Accuracy Over Time',
            yaxis: { title: 'Match (1=Hit, 0=Miss)', range: [-0.1, 1.1] },
            xaxis: { title: 'Date' }
        };

        Plotly.newPlot('accuracyChart', [trace], layout);
    </script>
</body>
</html>
